# Security Checklist

Source: https://processwire.com/docs/security/file-permissions/
Source: https://processwire.com/docs/security/admin/
Source: https://processwire.com/docs/security/web-hosting/
Source: https://processwire.com/docs/security/migration/
Source: https://processwire.com/docs/security/remove-unnecessary-files/
Source: https://processwire.com/docs/security/sessions/
Source: https://processwire.com/docs/security/third-party-modules/
Source: https://processwire.com/docs/security/template-files/
Source: https://processwire.com/docs/security/two-factor-authentication/

## Checklist

- ProcessWire security: file permissions: Getting your file permissions right is one of the most important factors in maintaining the security of your ProcessWire installation, particularly in non-dedicated/shared environments.Yet it's also one of the most difficult to get right, because there is no single correct answer that applies across all hosting environments. It is most definitely worth taking the time to make sure your file permissions are optimal for your environment.One of the first questions in determining what file permissions should be is whether Apache runs as your user account, or whether it runs as the same user for all accounts (like "nobody", "www" or "apache", for example). This is a question for your web host, as it depends entirely on their server configuration. Though if you want to do it yourself, there are a couple things you can do to make a reasonable determination yourself.Securing writable directories and filesPotential permissions for writable directories and filesPermission 755 for directories and 644 for filesWorst case: 777 for directories and 666 for filesWhere to modify ProcessWire's writable directory/file settingsHow to change permissions of existing filesSecuring your /site/config.php filePotential permissions for /site/config.phpDetermining what user apache runs asShould /site/modules/ be writable?Securing writable directories and filesWhen you install ProcessWire, it performs a check to see if the install.php file is writable. If it is, then there's a good chance (though not a guarantee) that Apache runs as your user account. If it detects this, it will recommend the 755 permission for writable directories and 644 permission for writable files, as a starting point. This translates to directories and files that are writable only to you, but readable to everyone else.If the installer populates 777 and 666 permissions, this translates to directories and files that are readable and writable to everyone, which is not a good scenario in shared environments. But without knowing more about the hosting environment, they may be the only permissions that we know for certain will enable ProcessWire to run. In either case, please read on for more details. In most cases you can further lock down these permissions with a little more information.Potential permissions for writable directories and filesPermissions below are organized in order of most secure to least secure. If Apache runs as you, chances are you can use the most secure permission options. When possible, inquire with your web host as to which permissions are best to use in your environment.Potential permissions for writable directories700 [rwx------] writable by owner, readable by owner (most secure, if it works)750 [rwxr-x---] writable by owner, readable by owner and group755 [rwxr-xr-x] writable by owner, readable by all (details)770 [rwxrwx---] writable by owner and group, readable by owner and group775 [rwxrwxr-x] writable by owner and group, readable by all777 [rwxrwxrwx] writable by all, readable by all (not secure, details)Potential permissions for writable files600 [rw-------] writable by owner, readable by owner (most secure, if it works)640 [rw-r-----] writable by owner, readable by group644 [rw-r--r--] writable by owner, readable by all (details)660 [rw-rw----] writable by owner and group, readable by owner and group664 [rw-rw-r--] writable by owner and group, readable by all666 [rw-rw-rw-] writable by all, readable by all (not secure, details)Is "writable by group" safe in a shared hosting environment?It depends who group implies. If group is the same as owner then it's just as safe as without any group permissions, though also not much point to it. But if group is instead the same group that other users on the system belong to, then it's not any safer than "writable by all".A common situation in web hosting is for group to be the same group belonged to by Apache (but not by other users), so that one could use a 770 for directories or 660 for files to give write permission to Apache without giving it to other users on the system.There's still a significant danger here though: other users on the system may still be able to create a PHP (or other language) script that runs as Apache, and thereby has all the group permissions that Apache does. In such a case, that user can still gain access to your files, if they are motivated enough and know what they are doing. That's assuming the hosting environment permits it. But last we tested, many still do. For these reasons, it's important to consult with your web host on what are the ideal permissions for your environment. For these same reasons, we recommend hosting in a dedicated environment whenever possible (regardless of CMS).Is "writable by all" safe in a dedicated hosting environment?If there aren't other users/accounts on the same server, then potentially yes, for the moment anyway. If there's nobody else on the server to consider, then "all" isn't anyone except you and your site. But we still recommend avoiding "writable by all" when possible because of what lies in the future. We simply don't know. Perhaps more accounts will be added to the server, perhaps the site will move to another server at some point, or perhaps some other part of the server or will get exploited. If you can avoid "writable by all" in your dedicated environment–even if it isn't technically necessary–you are buying some potential insurance for the future… though hopefully insurance that you'll never need.Permission 755 for directories and 644 for filesIf you see the installer identify these permissions (755 and 644), they are a good place to start. Though we recommend you confirm with your host, as well as check if the permissions can be locked down further. For instance your host may recommend 700 for directories and 600 for files, which would make files writable only to you and readable only to you (which is great, if it will work). Or they may recommend 750 and 640 which would make files writable and readable to you, and readable to a group. Alternatively, your host may recommend something entirely different, so take the time to find out what's right for your environment. In the end, if 755 and 644 work for your environment, further potential tweaks could worthwhile but may not be urgent.Worst case: 777 for directories and 666 for filesIf the installer populates permissions 777 for directories and 666 for files that means that it was unable to determine what the writable permissions should be, and 777/666 are the only permissions that we know for certain will work. However, these permissions are a worst-case scenario in terms of security, and you should not consider them unless in a dedicated environment. Those permissions effectively make the files readable and writable to all accounts on the server. That's not necessarily a problem if you are the only account on the server, but potentially a big problem if there are others. Particularly if you are in a shared environment, take the time to consult with your web host on what permissions to use for Apache-writable directories and files.Where to modify ProcessWire's writable directory/file settingsYour /site/config.php file contains two settings that control the writable directory and file settings:// permission for directories created by ProcessWire $config->chmodDir = '0755';// permission for files created by ProcessWire $config->chmodFile = '0644';Note that these permissions should be provided like above, as a string preceded with a 0. In other contexts (like with chmod, or perhaps your FTP client) you typically would omit the leading 0 that you see above.When you change the values of these two $config properties, it only affects directories and files created from that point forward. Any existing directories and files continue to have the existing permissions they already had. As a result, any time you make changes to these settings, you should also perform a recursive change to the permissions of all files in ProcessWire's writable directories. This includes /site/assets/ and everything within it, as well as /site/modules/ and everything in it (if you want to have a writable modules file system). Read the next section for details on how to do this.How to change permissions of existing filesIf you have SSH access to your account, a recursive permission can be performed with chmod. If you have FTP access to your account, most FTP clients support recursive permission changes, but usage will vary. We'll cover use of chmod here, since usage will always be the same. The following examples all assume you are executing chmod from the root installation of your ProcessWire site (the same directory where index.php is located).Change the permission of just one fileReplace /site/config.php with name of file you want to change, and replace 600 with permission you want to use. chmod 600 site/config.phpChange the permission of just one directoryReplace site/assets with the name of the directory you want to change, and replace 755 with the permission you want to use. chmod 755 site/assetsThe above would only change the permission for the site/assets directory, and not any directories within it. To change the permission of the site/assets directory and all directories within it recursively, see below. Change the permission of ALL directories (recursively)Replace site/assets with the name of the starting directory you want to change, and replace 755 with the permission you want to use. find site/assets -type d -exec chmod 755 {} \;Change the permission of ALL files (recursively)Replace site/assets/ with the name of the directory where files are located, and replace 644 with the permission you want to use. find site/assets/ -type f -exec chmod 644 {} \;Securing your /site/config.php fileIn a typical ProcessWire installation, your /site/config.php file is the one file that you need to make sure is not readable to any other user on the system (other than yourself and Apache). This file contains your database login and password information (and potentially other confidential information), so it's particularly important to lock this one down.In addition, the /site/config.php file needs to be writable by the installer (so it can record your settings), but it doesn't need to be writable afterwards. So it's a good idea to make adjusting the permissions of this file part of your regular installation process.As with other file permission settings, your /site/config.php permissions are primarily a consideration if you are in a shared (non-dedicated) hosting environment. In a dedicated environment, there aren't other potential users to worry about.While you can consult with your web host on what the best permissions for this file might be, you can also test things out yourself fairly easily. You can experiment with most restrictive permissions to least restrictive, until you find one that works.To change the permissions of this file, use chmod (if connected to your account via SSH) or use the permission settings in your FTP client. Usage will vary by FTP client. If using chmod from SSH, usage is as follows (replace "400" with whatever permission you want to apply): chmod 400 site/config.phpPotential permissions for /site/config.phpBelow are potential settings, ordered from most secure to least secure. Find the setting that works with your server, that balances your needs and security the best.How can you tell if the setting works with your server? Simply change the permission and load your site in a web browser. If you get your site, the setting worked. If you get an error message, 404 or nothing at all, the setting didn't work. Thats all there is to it.Recommend settings if you don't need write access: 400 [r--------] readable by owner (most secure, if it works)440 [r--r-----] readable by owner and group (if 400 doesn't work)Recommended settings if you need write access: 600 [rw-------] readable and writable by owner (most secure, if it works)640 [rw-r-----] readable and writable by owner, readable to group660 [rw-rw----] readable and writable by owner and groupNot recommended unless nothing else will work:*444 [r--r--r--] readable by all644 [rw-r--r--] readable by all, writable to owner664 [rw-rw-r--] readable by all, writable to owner and group* Should be okay in a dedicated environment. Determining what user apache runs asThis is a question for your web host, but if you are the DIY type, there's a way to find out yourself. Paste the following into a test.php file on your server and then load it in your browser:<?php echo exec('whoami');If the result is your account name, then Apache is running as you. This means you can most likely use more restricted permissions like 700, 750 or 755 for writable directories and 600, 640 or 644 for writable files.If the result is something else, like "nobody" or "apache" (or another you don't recognize) then Apache is not running as you, and you'll have to open up write permissions to group (i.e. 770 and 660) or [worst case] everyone (like 777 and 666). But before you even consider using permissions like 777 and 666 in a non-dedicated environment, consult with your web host as they will hopefully have a better recommendation.If you get an error message or nothing, then chances are exec() is not enabled for your server, as a security precaution. If that's the case, use this alternative script:<?php echo file_put_contents("test.txt", "test");If you get a positive number number and no error message then Apache is most likely running as you–read item #1 above. If you get the number 0 and/or an error message, Apache is most likely not running as you–read item #2 above.Remember to delete your test.php file (and test.txt file, if applicable).Should /site/modules/ be writable?When you install ProcessWire, if it detects that your file system is writable by default (indicating that Apache is likely running as you), then you may wish to likewise maintain a writable /site/modules/ directory. This enables you to upload, pull, install, update and delete modules from your admin, which is a nice convenience.However, that convenience comes with a compromise. Writable directories with executable PHP files is making a compromise in terms of security. If a superuser account on your system is ever hacked into, you've got problems.If your environment is non-dedicated and you have to supply any "all" (or even "group") write permissions, then don't have a writable /site/modules/ directory. You are safer just installing modules by FTP in this environment.To reiterate and put it in different terms: if your writable permissions for ProcessWire require any permission higher than 755 for directories or 644 for files, and you are not in a fully dedicated environment, then do not have a writable /site/modules/ directory under any circumstance. Manage your modules with other tools (FTP, SCP, rsync, etc.) in this scenario
- ProcessWire security: securing your admin control panel: Information about the design and purpose of the admin environment and how to protect it. Overview of securing your admin, preventing attacks, SSL certificates, tracking logins, enabling 2FA, managing page edit access and other security best practices.About the admin environmentWho the admin is for and who it is notHiding your admin URLPreventing dictionary attacksInstall an SSL certificate and require https for your adminKeep track of loginsDon't install the “forgot password” module unless you need itChoose strong passwordsInstall 2-factor (or multi-factor) authenticationManaging the security of page edit access in the adminAbout the admin environmentWith some CMS products, the admin environment crosses over with the front-end themed environment, and in fact may even be the same thing. In environments like that, both front-end and admin users might use the same login form and edit their profile settings (email, password, etc.) in the same location, among other things. In such environments, there is a grey area between what is admin and what is not. ProcessWire’s admin is the exact opposite of this, and there is no grey area.ProcessWire completely isolates the front-end from the admin environment with no crossover between the two. It is an administrative tool, exclusively for trusted users. While the front-end is for everyone else. This enables us to lock-down the security of the front-end to a greater extent than might otherwise be possible, while opening up the capabilities and power of the admin environment more than if it were shared with the front-end.Using an isolated admin also promotes greater long term content portability for the site, as content administrators remain focused on long term semantics over short term style. This ensures that when the front-end is redesigned, the underlying content remains semantic enough to work within any design.To reinforce ProcessWire as a trusted-user only environment, a user must have (at minimum) page-edit permission in one of their assigned roles (whether assigned to any templates or not). Otherwise the user will not be able to use the admin environment. The intention here is to prevent developers from utilizing the admin as a front-end environment, ensuring the integrity of the separation between isolated admin and front-end is maintained.Who the admin is for and who it is notIn ProcessWire's fully isolated admin environment, it's important to understand who the admin environment is for and who it is not. The intention behind the admin is to give the user as much power and control as possible for administering and editing the website/application content. Within the admin is the power to make or break the site; an environment for trusted users only.Trusted users are individuals that you trust with the content and operation of your website/application; Users that you trust to use correct terminology and spelling in content; Users that you trust to maintain security best practices and strong, secure passwords that are kept confidential; Users you trust not to deface, compromise, insert/upload offensive or illegal content, or even experiment with doing any of these things. Such trusted users might include your web developers, administrators and highly trusted editors of the site and its content. You should have an understanding and trust that users you assign access to are not there to even experiment with harmful actions to the site. The ProcessWire admin is designed for these trusted users only, and not for any others.Superusers and other users with the ability to edit and/or publish site content should be trusted in the same way you would trust someone to compose an email for you, and in the same way you would trust someone with ftp access to the site. While the access is certainly not the same (no they can't compose your email and they don't have ftp access), the level of trust should be the same. If it is not, then you should maintain a workflow and approval process between the source of the content and the trusted user that posts the content.With an understanding of the power and scope of the admin environment, you'll want to protect it in several ways, which we'll discuss below.Hiding your admin URLThe default ProcessWire admin URL is domain.com/processwire/. If you want to hide the location of your admin URL, you can rename it. You have the option of doing this during the installation process. You can also do it from the ProcessWire admin. Here's how:Login to your ProcessWire admin. In the page tree, click and edit the Admin page.Click the Settings tab and change the Name field to something different. After changing it, save.You will get a 404 error–this is normal, because your admin no longer lives at the previous URL.In your browser address bar, enter your new admin URL and you are good to go.Preventing dictionary attacksYou'll be glad to know that your ProcessWire admin login is secured automatically from dictionary attacks by the Session Login Throttle module, which is installed by default. This module throttles repeated login attempts, preventing the same username from being attempted for login more than once in 5 seconds. Every failed login attempt increases that waiting period exponentially, making rapid-fire dictionary attacks nearly impossible.You can further lock down the settings of this module by configuring it (in Modules > Core > Session > Login Throttle). If your admin doesn't have simultaneous users coming from the same shared IP address, we recommend checking the box to enable throttling by IP address. When checked, not only will attempts for the same username be throttled, but any attempts (regardless of username) will be throttled by IP address as well.The only reason that we don't have this "throttle by IP" box checked by default is because some clients have multiple users coming from the same IP address. In that instance, one person forgetting their password could temporarily prevent other people from logging in.Install an SSL certificate and require https for your adminWeb traffic is inherently insecure and everything sent to and from the server is unencrypted. This includes any login information you use to get into your admin, as well as cookies used to maintain your session. By installing an SSL certificate, you drastically reduce the potential for this information to be intercepted over the network by 3rd parties. As a result, installing an SSL certificate is one of the best security upgrades you can make for your site.Once you've got an SSL certificate installed on your server, you need to make sure that it is put to use. At minimum, we recommend locking down your "admin" template to only allow https traffic. However, make sure that your site is accessible via https://yourdomain.com before you do this, otherwise you could lock yourself out of the admin.Once confirmed that your site is accessible via https, login to your admin (using the https URL), and do the following:Click "Setup" then "Templates" (click the Templates label rather than a specific template).Click the "Filters" box, then "Show system templates", and choose "Yes".When the page reloads, you'll have a "System" section where you will see an "admin" template. Click "admin".Click the "URLs" tab and scroll to the "Scheme/Protocol" section. Click "HTTPS only" and Save.Keep track of loginsA good security practice is to keep track of who is using the ProcessWire admin. It can be helpful to keep track of both successful and failed logins, and may serve as an early warning when someone is snooping around. You can access the built-in session log via Setup > Logs > session.If you'd like more information or options than what the default session log includes, take a look at the Login Notifier module by Ryan Cramer or the Login History module by Teppo Koivula.Don't install the “forgot password” module unless you need itProcessWire comes with a module called Process Forgot Password, which can be installed in your admin under Modules > Core > Process > Forgot Password. This can be very handy for many installations. But if it's something that your installation doesn't need, then don't install it.While we've gone to great efforts to ensure our forgot password module is secure (and in fact, more secure than any other we've seen), it still involves emailing the user a time-limited link to reset their password. As you may already know, email is not the safest way to transport confidential information, so limiting what can happen with email [when you can] is worthwhile.It's worth noting that ProcessWire's forgot password function only works if the session that requested the reset is the same session that clicks the email link and performs the reset. That provides an additional layer of security over other password reset functions that we've seen. But if your email account is compromised, then all bets are off: your ProcessWire password then has the potential to be compromised as well. So if your site doesn't absolutely need a forgot password function, then don't install it.Choose strong passwordsThis goes without saying, but regardless of how well your admin URL is hidden, you should make sure you (and any other ProcessWire user accounts) have good passwords that aren't used elsewhere. You can enforce password strength settings from the "pass" field settings, editable in the admin from Fields > Show System Fields > Edit ("pass" field).Install 2-factor (or multi-factor) authenticationProcessWire supports 2-factor authentication (2FA/TFA/MFA) natively and can be used with applications like Authy, Google Authenticator, Microsoft Authenticator, LastPass and others supporting TOTP (time-based one-time protocol).To start using it, you'll want to install the 1st party TfaTotp module. You may also want to install the TfaEmail module as a 2nd option, which may not be as secure as TOTP, but can be an easier path for some users, and enables you to enforce 2-factor authentication automatically. Other Tfa module options may also be available in the modules directory Tfa page. Once one or more Tfa modules are installed, you can enable them to be used in admin by configuring the ProcessLogin module settings (Modules > Configure > ProcessLogin).See this page for more details on two-factor authentication in ProcessWireManaging the security of page edit access in the adminThe primary purpose of ProcessWire’s admin is to manage the pages of the site or application, along with other resources that support them (templates, fields, modules, etc.).You can control which trusted users can edit which pages, assignable per-role and by-template. When using access control settings to manage page-edit access, you should limit access to edit system pages (which include homepage, 404 page, and everything within the admin page structure) to superusers only; as well as search, sitemap or other types of single-purpose pages you might be using in your site (if you are using them). Superusers can already edit everything, so you can achieve this by simply not assigning any edit access to these system pages at all.Assign edit access to specific content types rather than general purpose onesWhen possible, page edit access should be assigned to templates representing specific content types rather than general purpose ones. For example, if you have a user that you only want to edit your terms-and-conditions page, then make sure that terms-and-conditions page is using its own template (rather than a "basic-page") one, so that you can assign edit access to just that page. When your system is using a "basic-page" type template (whether named that or not) do not use it for assigning page-edit access control, since it may be used by many general purpose pages. When you need to assign edit access to pages using such template(s), clone the template to a new one, set the page to use it, and assign the necessary edit access to the new template.Do not assign edit permissions on the homepage templateThe home (homepage) template is access controlled already, and other non-access controlled pages below it inherit access settings from it. This is very useful when it comes to view permission (which is required here), so it may be tempting to use it as a quick solution to assign site-wide edit access. But you should avoid this temptation, do not assign roles edit permission to the home template. Why not? First off, if we want to stick to best practices, superuser should be the only role with site-wide edit access. Secondly, edit access assigned at the homepage inherits down through the tree in a way that can be ambiguous. Instead, create roles with specific purposes that can edit specific content types (templates), and assign as many roles as you need to a particular user, consistent with their edit needs. Non-superusers should not be able to directly edit the root (home) page in the site. If you have a user that needs to edit homepage content, the homepage should pull content from other pages using templates that you assign access to separately.Field-level access controlAfter taking the standard template-level access control into account, consider that ProcessWire also supports field-level access control. This can be useful for controlling access to pages where you want the user to be able to edit some parts of it and not others.Balancing complexityBe careful not to over-complicate your access control settings beyond your security needs. ProcessWire will let you create very powerful and complex access control scenarios in your admin, but that doesn't mean that you should. Increasing complexity can also reduce security, as the who/what/where of access control becomes more difficult to keep track of. For this reason, only introduce fine granular access control settings (such as field-level access control) into your installation in cases where you need it, and where it adds additional clarity or simplicity to the overall access control setup. Find the right balance that maximizes security while limiting complexity
- ProcessWire security: web hosting: When possible, your production sites running ProcessWire (or any CMS) should ideally be in a dedicated environment. This doesn't necessarily mean a dedicated server…Rather, it means any environment where the file system is dedicated only to your website(s). Meaning, there aren't other users on the same server that can potentially see (or worse, modify) the files of your account(s) on the same server.This dedicated environment could be a dedicated server, VPS, cloud server, or even shared hosting where accounts are completely jailed from one another. If in doubt, inquire with your web host about whether or not your environment is dedicated and/or completely jailed from other people. Typically, the budget hosting accounts are not dedicated environments, so be careful and choose wisely.When in a dedicated environment, you have less to consider in terms of file security, and this is one of the main reasons why we recommend it. File permissions are not as great of a concern because there is not the possibility of other users on the same server getting into your files, regardless of your file permission settings. That doesn't mean that you can disregard file permissions as a security matter, but a dedicated environment does greatly reduce the odds of having uninvited guests shopping around in your files
- ProcessWire security: migrating to production: Unless the production server is a completely dedicated environment, don't assume that what was safe on your development server will also be safe on the production server.The server configuration and necessary permissions between your development server and production server may be completely different. Take the time to revisit all the pages in this security section (particularly file permissions) with the context specific to your production server. In particular, pay attention to your writable file system permissions for /site/assets/, /site/modules/ and everything in them, as well as your /site/config.php file. You may need to make a recursive change to all files in that directory after migrating to production. For instance, if your production server has Apache running as your account, and your development server didn't, then you should lock down the permissions consistent with what the server supports.Potential permissions for writable files and directoriesHow to change permissions of existing directories and filesSecuring your /site/config.php fileDetermining who Apache runs asYou might also find it worthwhile to install a test copy of ProcessWire on your production server before migrating your site to it. The installer can identify many potential issues ahead of time, saving you the hassle of figuring things out during migration. Remember to delete the test installation afterwards
- ProcessWire security: remove unnecessary files: ProcessWire comes with several files that you will no longer need after installation.The installer gives you the opportunity to remove these automatically, but if you didn't let it, or if it was unable to for some reason, you should remove them yourself. In either case, double check that these files/directories are removed after installation:/install.php/site-default//site-languages//site-beginner//site-blank//site-classic//site/install/If you have any 3rd party modules installed that are no longer in use, uninstall and erase them from the file system
- ProcessWire security: database driven sessions: Database-driven sessions offer potentially better security since the session information is not stored on the file system.ProcessWire comes with the option to use database-driven sessions, but it is not turned on by default. However, in a shared environment, database-driven sessions offer potentially better security since the session information is not stored on the file system.To enable database-driven sessions, login to your admin and go to Modules > Core > Session > Session Handler Database. Click the Install button. Database-driven sessions will be enabled immediately, which means you are immediately logged out. Simply log back in, and your system is now using database-driven sessions.As a bonus, you can now monitor live traffic on your site from Setup > Sessions. If you want the information present on this screen to include IP address and/or user agent, enable these options from the Session Handler Database module configuration screen
- ProcessWire security: third party modules: We can vouch for the security of the code that we write in the ProcessWire core, but we can't vouch for the security of third party modules. Follow these guidelines to maximize your security with third party modules.ProcessWire doesn't require any third party modules in order to run and accomplish most tasks, so use care in deciding which third party modules to install.Install only those modules that solve an important need for your site. The fewer 3rd party modules you have installed, the less to keep track of and fewer developers you are dependent upon.Verify that the module is still actively supported by developer in the ProcessWire support boards.Keep third party modules up-to-date (the ProcessWireUpgrade module is a good way to track versions).Uninstall and erase any 3rd party modules that you have installed but are not using
- ProcessWire security: template files: While ProcessWire handles a lot of the common security considerations before your template files are even loaded, you should also follow security best practices within your template files as you would in any other PHP framework.Your ProcessWire installation is only as secure as your template files. ProcessWire template files are PHP files, and anything that is possible in PHP is also possible in your template files.If your template files deal with any kind of user input, they must sanitize and validate any user input. Never send any kind of user input directly to ProcessWire's API methods (other than those provided by $sanitizer) without first sanitizing it, and validating it where appropriate.For example, here is something you don't want to do. This code block is sending the GET variable $text directly to a $pages->find() call, without sanitizing the value or even confirming that it was present:// do not do this $text = $input->get('text'); $items = $pages->find("body%=$text");Here is the same example as above, but with sanitization (for use in a selector string) and confirmation that the value is present before attempting to use it:$text = $sanitizer->selectorValue($input->get('text')); if($text) { $items = $pages->find("body%=$text"); }This is only a single ProcessWire-specific example, but the scope of PHP best practices for handling user input is outside the scope of this document. When in doubt, ask in our forums. If dealing with user input, get familiar with ProcessWire's built-in $sanitizer as well as general PHP data filtering and sanitization and other PHP security best practices, as your project scope and needs dictate
- 2-factor authentication: Two-factor (or multi-factor) authentication gives you an extra layer of account security relative to just using a password. ProcessWire versions 3.0.109 and newer include core support for two-factor authentication.The ProcessWire core provides the API, interface and flow control for the two-factor authentication process. But the actual implementation is handled by modules that extend the Tfa base module class. In this section we'll cover details on two different modules for implementation of two-factor authentication. To begin using two-factor authentication, you'll want to install one of these modules:TfaTotp for TOTP 2-factor authentication (time-based one time protocol)TfaEmail for Email/SMS 2-factor authenticationWhich two-factor authentication module should you use?The addition of any two-factor authentication to your login process is going to be a nice security improvement. The more options you provide, the more likely your users will adopt it. So at this stage, unless you are wanting to stick with a specific standard or application, it makes sense to install multiple two-factor authentication modules.How it worksWhen you install one or more Tfa modules, the ProcessWire core automatically adds a new field to your user template, called tfa_type. This field is editable from the user profile screen, and enables the user to select what two-factor authentication type they want to use:After making a selection, it will ask you to enter your current password for security purposes. Save your profile, and 2-factor authentication is ready to configure. In this case, I've selected the TOTP two-factor authentication:Open an Authenticator application on your phone, tap "add account" and it'll ask you to hold your phone up to the QR code so that it can record it and save it. Once it's in the authenticator application, it starts generating new codes for it every 30 seconds. Enter the first code that it generates for you and hit Save. Now your account has two-factor authentication enabled.If you need a backup of your secret/private-key: technically you could copy the "Secret" string and store it somewhere securely. Or I suppose you could copy/paste the QR code if you preferred. I'm not saying you should, just saying you can. Keeping copies of these things ultimately makes it more convenient if you lose access to your phone/application, though having copies also makes it less secure.With two-factor authentication now enabled, the next time you login, you'll get the following second-step after completing your username/password login:You'll have about 90 seconds to get it right, as it'll accept the current, previous, or next 30-second codes, to account for any time differences or delays between the server and client. If you can't get the code right in a few tries (not likely), it'll abort and make you re-authenticate with your username and password.To begin using two-factor authentication in ProcessWire, install one of the “Tfa” modules:TOTP 2-factor authentication (TfaTotp)TOTP standards for “Time-based One-Time Password”, which is an algorithm that computes a one-time password. It does this with a…Learn more →Email/SMS 2-factor authentication (TfaEmail)This is a push-based two-factor authentication method, where it sends out an email or SMS message to you with your authentication…Learn more →
